<section>
    <app-admin-header></app-admin-header>
    <app-sidebar></app-sidebar>
    <router-outlet></router-outlet>
</section>

<!-- mobile view -->
<div class="mobile-only text-center">
    <div class="w-100 position-absolute top-50 start-50 translate-middle">
        <i class="bi bi-phone fs-1"></i>
        <p>This page is hidden for mobile size</p>
    </div>
</div>

<section class="content desktop-only">
  <div class="container-fluid">
    <div class="row">
      <!-- left box -->
      <div class="col-md-8">
        <!-- category row -->
        <div class="row mb-3 mb-lg-4">

          <div class="col-md-7">
            <div class="menu-container">
              <a [class.active]="selectedCategoryId === 0" (click)="onCategoryChange(0)">All</a>
              <a *ngFor="let category of categories" 
                [class.active]="selectedCategoryId === category.id"
                (click)="onCategoryChange(category.id)">
                {{ category.name }}
              </a>
            </div>
          </div>

          <div class="col-md-5">
            <div class="pt-1">
              <!-- <label for="">Search Menu</label> -->
              <input type="text" class="form-control" placeholder="Search foods here..." 
                (keyup)="onSearch($event)" 
                [(ngModel)]="searchTerm" />
            </div>
          </div>

        </div>
        <!-- menu items -->
        <div class="row ms-1 mt-2">
          <div class="col-md-3" *ngFor="let item of displayedMenu">
            <div class="foodCard shadow mb-4 p-2 d-flex flex-column justify-content-between">
              <div>
                <div class="imgDiv">
                  <img [src]="item.imageUrl || 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT174vzFl74O_C9GdKNIE1JJ0dPd55RqjGtVw&s'"
                    alt="" class="img-fluid rounded" />
                </div>
                <h5>{{item.name}}</h5>
              </div>
              <div class="d-flex justify-content-between align-items-center text-center mb-2">
                <p class="mb-0">Rs {{item.price}}</p>
                <button class="btn btn-dark btn-sm" (click)="addToCart(item)">+</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- right box -->
      <div class="col-md-4">
        <div class="cart">
          <div class="row">
            <div class="d-flex gap-2 p-3 pb-0 cartHeader">
              <i class="bi bi-bookmark-fill"></i>
              <p>Order Details</p>
            </div>
          </div>
          <!-- cart items -->
          <div class="row m-2">
            <div class="cartItemsSection">
              <div class="col-md-12 p-2 mb-3 itemCard" *ngFor="let cartItem of cartItems">
                <div class="row">
                  <div class="col-4">
                    <div class="imgDiv">
                      <img [src]="cartItem.imageUrl || 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTqtEdWNhGR6ajlvJSDIfrIGORiC56zODEmLQ&s'"
                        alt="" class="img-fluid" />
                    </div>
                  </div>
                  <div class="col-8">
                    <div class="d-flex justify-content-between">
                      <div>
                        <p>{{ cartItem.name }}</p>
                        <p class="text-warning">Rs {{ cartItem.price }}</p>
                      </div>
                      <div>
                        <button class="btn btn-danger btn-sm" (click)="removeFromCart(cartItem)">
                          <i class="bi bi-x-lg"></i>
                        </button>
                      </div>
                    </div>
                    <div class="item-qty-selector d-flex align-items-center justify-content-center">
                      <button class="btn btn-sm item-qty-btn" (click)="decreaseQty(cartItem)">âˆ’</button>
                      <span class="item-qty-value mx-3">{{ cartItem.qty }}</span>
                      <button class="btn btn-sm item-qty-btn" (click)="increaseQty(cartItem)">+</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- cart summary -->
            <div class="amountSection mb-2">
              <p>Gross Amount <span class="float-end">Rs {{ grossAmount }}</span></p>
              <p>Tax or Service Charge (0%) <span class="float-end">Rs {{ taxAmount }}</span></p>
              <p>
                <strong>Total</strong>
                <span class="float-end fw-bold">Rs {{ totalAmount }}</span>
              </p>
            </div>
            <div class="p-1 d-flex justify-content-between gap-2">
              <button class="btn btn-danger w-25" (click)="clearCart()">Clear</button>
              <button class="btn btn-warning w-75" (click)="payTakeAway()">Paid</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
